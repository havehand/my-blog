{"version":3,"sources":["webpack:///./src/components/MessageArea/DataList.vue?63e7","webpack:///./src/views/Message/index.vue?ebf1","webpack:///./src/utils/formatDate.js","webpack:///./src/components/MessageArea/DataForm.vue?5a37","webpack:///./src/components/MessageArea/index.vue?624a","webpack:///./src/misins/fetchData.js","webpack:///./src/components/MessageArea/index.vue?9063","webpack:///./src/components/MessageArea/DataForm.vue?94c6","webpack:///src/components/MessageArea/DataForm.vue","webpack:///./src/components/MessageArea/DataForm.vue?a290","webpack:///./src/components/MessageArea/DataForm.vue","webpack:///./src/components/MessageArea/DataList.vue?91c2","webpack:///src/components/MessageArea/DataList.vue","webpack:///./src/components/MessageArea/DataList.vue?bfc3","webpack:///./src/components/MessageArea/DataList.vue","webpack:///src/components/MessageArea/index.vue","webpack:///./src/components/MessageArea/index.vue?260e","webpack:///./src/components/MessageArea/index.vue","webpack:///./src/views/Message/index.vue?a320","webpack:///./src/api/message.js","webpack:///src/views/Message/index.vue","webpack:///./src/views/Message/index.vue?4bed","webpack:///./src/views/Message/index.vue"],"names":["timestamp","showTime","date","Date","month","getMonth","toString","padStart","day","getDate","str","getFullYear","hour","getHours","minute","getMinutes","second","getSeconds","defaultDataValue","data","isLoading","this","fetchData","render","_vm","_h","$createElement","_c","_self","staticClass","on","handleSubmit","_v","_s","title","subTitle","attrs","list","directives","name","rawName","value","expression","staticRenderFns","ref","$event","preventDefault","apply","arguments","formData","domProps","target","composing","$set","nickname","length","error","content","isSubmitting","methods","$emit","$showMessage","success","type","duration","container","$refs","callback","component","_l","item","key","id","avatar","formatDate","createDate","components","Avatar","props","Array","default","String","isListLoading","Boolean","DataForm","DataList","undefined","total","rows","_e","async","getMessages","page","limit","request","get","params","postMessage","msgInfo","post","mixins","MessageArea","endRequest","messageContainer","addEventListener","handleScroll","computed","isEnd","surplus","obj","hasMore","console","log","trueLimit","resp","concat","blogId","$route","unshift","dom","range","dec","Math","abs","scrollTop","clientHeight","scrollHeight","fetchMore"],"mappings":"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","file":"js/chunk-577a5925.1646f5b4.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataList.vue?vue&type=style&index=0&id=14f61be8&scoped=true&lang=less&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=48c2e00c&scoped=true&lang=less&\"","export default function(timestamp, showTime = false) {\r\n    const date = new Date(+timestamp);\r\n    const month = (date.getMonth() + 1).toString().padStart(2, \"0\");\r\n    const day = date\r\n        .getDate()\r\n        .toString()\r\n        .padStart(2, \"0\");\r\n    let str = `${date.getFullYear()}-${month}-${day}`;\r\n    if (showTime) {\r\n        const hour = date\r\n            .getHours()\r\n            .toString()\r\n            .padStart(2, \"0\");\r\n        const minute = date\r\n            .getMinutes()\r\n            .toString()\r\n            .padStart(2, \"0\");\r\n        const second = date\r\n            .getSeconds()\r\n            .toString()\r\n            .padStart(2, \"0\");\r\n        str += ` ${hour}:${minute}:${second}`;\r\n    }\r\n    return str;\r\n}\r\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataForm.vue?vue&type=style&index=0&id=5aa7012e&scoped=true&lang=less&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1735bb7c&scoped=true&lang=css&\"","export default function (defaultDataValue = null){\r\n    return {\r\n        data(){\r\n            return{\r\n                isLoading: true,\r\n                data: defaultDataValue\r\n            }\r\n        },\r\n        async created(){\r\n            this.data = await this.fetchData();\r\n            this.isLoading = false;\r\n        }\r\n    }\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"message-area-container\"},[_c('DataForm',{on:{\"submit\":_vm.handleSubmit}}),_c('h3',[_vm._v(\" \"+_vm._s(_vm.title)+\" \"),_c('span',[_vm._v(_vm._s(_vm.subTitle))])]),_c('DataList',{attrs:{\"list\":_vm.list}}),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.isListLoading),expression:\"isListLoading\"}],staticClass:\"loading\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"container\",staticClass:\"data-form-container\",attrs:{\"id\":\"data-form-container\"}},[_c('form',{attrs:{\"action\":\"#\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.handleSubmit.apply(null, arguments)}}},[_c('div',{staticClass:\"input-name\"},[_c('label',{attrs:{\"for\":\"user-name\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.formData.nickname),expression:\"formData.nickname\"}],attrs:{\"type\":\"text\",\"maxlength\":\"10\",\"placeholder\":\"用户昵称\",\"id\":\"user-name\"},domProps:{\"value\":(_vm.formData.nickname)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.formData, \"nickname\", $event.target.value)}}})]),_c('span',{staticClass:\"limit\"},[_vm._v(_vm._s(_vm.formData.nickname.length)+\"/10\")])]),_c('div',{staticClass:\"err\"},[_vm._v(_vm._s(_vm.error.nickname))]),_c('div',{staticClass:\"input-content\"},[_c('label',{attrs:{\"for\":\"input-area\"}},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.formData.content),expression:\"formData.content\"}],attrs:{\"maxlength\":\"300\",\"id\":\"input-area\",\"placeholder\":\"输入内容\"},domProps:{\"value\":(_vm.formData.content)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.formData, \"content\", $event.target.value)}}})]),_c('span',{staticClass:\"limit\"},[_vm._v(_vm._s(_vm.formData.content.length)+\"/300\")])]),_c('div',{staticClass:\"err\"},[_vm._v(_vm._s(_vm.error.content))]),_c('div',{staticClass:\"form-item\"},[_c('div',{staticClass:\"button-area\"},[_c('button',{staticClass:\"submit\",attrs:{\"type\":\"submit\",\"disabled\":_vm.isSubmitting}},[_vm._v(_vm._s(_vm.isSubmitting?\"提交中...\":\"提交\"))])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"data-form-container\" ref=\"container\" id=\"data-form-container\">\r\n    <form @submit.prevent=\"handleSubmit\" action=\"#\">\r\n      <div class=\"input-name\">\r\n        <label for=\"user-name\">\r\n          <input type=\"text\" maxlength=\"10\" placeholder=\"用户昵称\" id=\"user-name\" v-model=\"formData.nickname\"/>\r\n        </label>\r\n        <span class=\"limit\">{{formData.nickname.length}}/10</span>\r\n      </div>\r\n      <div class=\"err\">{{error.nickname}}</div>\r\n      <div class=\"input-content\">\r\n        <label for=\"input-area\">\r\n          <textarea maxlength=\"300\" id=\"input-area\" placeholder=\"输入内容\" v-model=\"formData.content\"></textarea>\r\n        </label>\r\n        <span class=\"limit\">{{formData.content.length}}/300</span>\r\n      </div>\r\n      <div class=\"err\">{{error.content}}</div>\r\n      <div class=\"form-item\">\r\n        <div class=\"button-area\">\r\n          <button type=\"submit\" class=\"submit\" :disabled=\"isSubmitting\">{{isSubmitting?\"提交中...\":\"提交\"}}</button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"DataForm\",\r\n  data(){\r\n    return{\r\n      formData:{\r\n        nickname: \"\",\r\n        content: \"\"\r\n      },\r\n      error:{\r\n        nickname: \"\",\r\n        content: \"\"\r\n      },\r\n      isSubmitting: false\r\n    }\r\n  },\r\n  methods:{\r\n    handleSubmit(){\r\n      this.error.nickname = this.formData.nickname? \"\":\"请填写昵称\";\r\n      this.error.content = this.formData.content? \"\":\"请填写内容\";\r\n      if (this.error.nickname || this.error.content){\r\n        return;\r\n      }\r\n      this.isSubmitting = true;\r\n      this.$emit(\"submit\", this.formData, (success)=>{\r\n        this.$showMessage({\r\n          content: success,\r\n          type: \"success\",\r\n          duration: 1000,\r\n          container: this.$refs.container,\r\n          callback: ()=>{\r\n            this.formData.nickname = \"\";\r\n            this.formData.content = \"\";\r\n            this.isSubmitting = false;\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"../../styles/var\";\r\n  .data-form-container{\r\n    position: relative;\r\n    .input-name{\r\n      position: relative;\r\n      margin: 30px 0;\r\n      #user-name{\r\n        width: 50%;\r\n        height: 35px;\r\n        border: 1px dashed darken(@gray, 30%);\r\n        border-radius: 5px;\r\n        padding-left: 15px;\r\n        outline: none;\r\n        font-size: 16px;\r\n        &:focus{\r\n          border: 2px dashed darken(@primary, 30%);\r\n        }\r\n      }\r\n     .limit{\r\n       position: absolute;\r\n       font-size: 10px;\r\n       color: @gray;\r\n       height: 100%;\r\n       top: 30%;\r\n       left: 48%;\r\n     }\r\n    }\r\n    .err{\r\n      color: @warn;\r\n      margin: 10px 0;\r\n    }\r\n    .input-content{\r\n      position: relative;\r\n      margin: 30px 0;\r\n      #input-area{\r\n        width: 90%;\r\n        height: 80px;\r\n        outline: none;\r\n        border: 1px dashed darken(@gray, 30%);\r\n        border-radius: 5px;\r\n        padding-left: 15px;\r\n        font-size: 16px;\r\n        resize: none;\r\n        &:focus{\r\n          border: 2px dashed darken(@primary, 30%);\r\n        }\r\n      }\r\n      .limit{\r\n        position: absolute;\r\n        font-size: 10px;\r\n        color: @gray;\r\n        top: 70%;\r\n        left: 87%;\r\n      }\r\n    }\r\n    .form-item{\r\n      .button-area{\r\n        @bgcolor: #6b9eee;\r\n        .submit{\r\n          width: 100px;\r\n          height: 35px;\r\n          background-color: @bgcolor;\r\n          color: white;\r\n          border: none;\r\n          border-radius: 5px;\r\n          cursor: pointer;\r\n          &:disabled{\r\n            background-color: lighten(@bgcolor, 15%);\r\n            cursor: not-allowed;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DataForm.vue?vue&type=template&id=5aa7012e&scoped=true&\"\nimport script from \"./DataForm.vue?vue&type=script&lang=js&\"\nexport * from \"./DataForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DataForm.vue?vue&type=style&index=0&id=5aa7012e&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5aa7012e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',{staticClass:\"data-list-container\"},_vm._l((_vm.list),function(item){return _c('li',{key:item.id},[_c('Avatar',{attrs:{\"url\":item.avatar,\"size\":44}}),_c('div',{staticClass:\"data\"},[_c('div',{staticClass:\"nickname\"},[_vm._v(_vm._s(item.nickname))]),_c('div',{staticClass:\"content\"},[_vm._v(_vm._s(item.content))]),_c('div',{staticClass:\"time\"},[_vm._v(_vm._s(_vm.formatDate(item.createDate, true)))])])],1)}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <ul class=\"data-list-container\">\r\n    <li v-for=\"item in list\" :key=\"item.id\">\r\n      <Avatar :url=\"item.avatar\" :size=\"44\" />\r\n      <div class=\"data\">\r\n        <div class=\"nickname\">{{ item.nickname }}</div>\r\n        <div class=\"content\">{{ item.content }}</div>\r\n        <div class=\"time\">{{ formatDate(item.createDate, true) }}</div>\r\n      </div>\r\n    </li>\r\n  </ul>\r\n</template>\r\n\r\n<script>\r\nimport Avatar from \"@/components/Avatar\";\r\nimport formatDate from \"@/utils/formatDate\";\r\nexport default {\r\n  components: {\r\n    Avatar,\r\n  },\r\n  props: {\r\n    list: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n  },\r\n  methods: {\r\n    formatDate\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"~@/styles/var.less\";\r\n.data-list-container {\r\n  list-style: none;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\nli {\r\n  display: flex;\r\n  border-bottom: 1px solid lighten(@gray, 20%);\r\n  padding: 15px 0;\r\n}\r\n.avatar-container {\r\n  margin-right: 15px;\r\n}\r\n.nickname {\r\n  color: darken(@success, 10%);\r\n  margin-bottom: 10px;\r\n}\r\n.content {\r\n  font-size: 14px;\r\n}\r\n.data {\r\n  flex: 1 1 auto;\r\n  position: relative;\r\n}\r\n.time {\r\n  position: absolute;\r\n  right: 0;\r\n  top: 5px;\r\n  font-size: 12px;\r\n  color: @gray;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DataList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DataList.vue?vue&type=template&id=14f61be8&scoped=true&\"\nimport script from \"./DataList.vue?vue&type=script&lang=js&\"\nexport * from \"./DataList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DataList.vue?vue&type=style&index=0&id=14f61be8&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"14f61be8\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"message-area-container\">\r\n    <DataForm @submit=\"handleSubmit\"></DataForm>\r\n    <h3>\r\n      {{ title }}\r\n      <span>{{subTitle}}</span>\r\n    </h3>\r\n    <DataList :list=\"list\"></DataList>\r\n    <div class=\"loading\" v-loading=\"isListLoading\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DataForm from \"@/components/MessageArea/DataForm\";\r\nimport DataList from \"@/components/MessageArea/DataList\";\r\nexport default {\r\n  name: \"index\",\r\n  props: {\r\n    title: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    subTitle: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    list: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    isListLoading: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  components:{\r\n    DataForm,\r\n    DataList\r\n  },\r\n  methods:{\r\n     handleSubmit(formData, callback) {\r\n       this.$emit(\"submit\", formData, callback);\r\n     }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .message-area-container{\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n  .loading {\r\n    position: relative;\r\n    height: 100px;\r\n  }\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1735bb7c&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1735bb7c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1735bb7c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.data.total !== undefined)?_c('div',{ref:\"messageContainer\",staticClass:\"message-container\"},[_c('MessageArea',{attrs:{\"title\":\"留言板\",\"sub-title\":(\"(\" + (_vm.data.total) + \")\"),\"list\":_vm.data.rows,\"isListLoading\":_vm.isLoading},on:{\"submit\":_vm.handleSubmit}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import request from \"./request\";\r\n\r\nexport async function getMessages(page = 1, limit = 10) {\r\n  return await request.get(\"/api/message\", {\r\n    params: {\r\n      page,\r\n      limit,\r\n    },\r\n  });\r\n}\r\n\r\nexport async function postMessage(msgInfo) {\r\n  return await request.post(\"/api/message\", msgInfo);\r\n}\r\n","<template>\r\n  <div ref=\"messageContainer\" class=\"message-container\" v-if=\"data.total !== undefined\">\r\n    <MessageArea title=\"留言板\" :sub-title=\"`(${data.total})`\" :list=\"data.rows\" @submit=\"handleSubmit\" :isListLoading=\"isLoading\"></MessageArea>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport MessageArea from \"@/components/MessageArea\";\r\nimport fetchData from \"@/misins/fetchData\";\r\nimport * as msgApi from \"@/api/message\";\r\nexport default {\r\n  mixins: [fetchData({ total: 0, rows: [] })],\r\n  components:{\r\n    MessageArea\r\n  },\r\n  data(){\r\n    return{\r\n      page: 1,\r\n      limit: 10,\r\n      endRequest: false\r\n    }\r\n  },\r\n  created() {\r\n  },\r\n  mounted() {\r\n    this.$refs.messageContainer.addEventListener(\"scroll\", this.handleScroll);\r\n  },\r\n  computed:{\r\n    hasMore(){\r\n      if (this.data.total > this.data.rows.length + this.limit){\r\n        return {\r\n          isEnd: false,\r\n          surplus: 0\r\n        };\r\n      }else{\r\n        return {\r\n          isEnd: true,\r\n          surplus: this.data.total - this.data.rows.length\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    async fetchData() {\r\n      return await msgApi.getMessages(this.page, this.limit);\r\n    },\r\n    async fetchMore() {\r\n      if (this.endRequest){\r\n        return;\r\n      }\r\n      const obj = this.hasMore;\r\n      if (obj.isEnd){\r\n        console.log(\"最后一次\");\r\n        this.isLoading = true;\r\n        const trueLimit = this.limit;\r\n        this.limit = obj.surplus;\r\n        const resp = await this.fetchData();\r\n        this.data.rows = this.data.rows.concat(resp.rows);\r\n        this.isLoading = false;\r\n        this.limit = trueLimit;\r\n        this.endRequest = true;\r\n      }else{\r\n        this.isLoading = true;\r\n        this.page++;\r\n        const resp = await this.fetchData();\r\n        this.data.total = resp.total;\r\n        this.data.rows = this.data.rows.concat(resp.rows);\r\n        this.isLoading = false;\r\n      }\r\n    },\r\n    async handleSubmit(formData,callback){\r\n      const resp = await msgApi.postMessage({\r\n        blogId: this.$route.params.id,\r\n        ...formData\r\n      });\r\n      this.data.rows.unshift(resp);\r\n      this.data.total++;\r\n      callback(\"留言成功\");\r\n    },\r\n    handleScroll() {\r\n      const dom = this.$refs.messageContainer;\r\n      if (this.isLoading){\r\n        return;\r\n      }\r\n      const range = 10;\r\n      const dec = Math.abs(dom.scrollTop + dom.clientHeight - dom.scrollHeight);\r\n      if (dec <= range){\r\n        this.fetchMore();\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.message-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow-y: auto;\r\n  padding: 25px 0;\r\n  box-sizing: border-box;\r\n  scroll-behavior: smooth;\r\n}\r\n.message-area-container {\r\n  width: 700px;\r\n  margin: 0 auto;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=48c2e00c&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=48c2e00c&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"48c2e00c\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}